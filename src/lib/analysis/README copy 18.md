# ğŸ“‹ **æ‹…å½“ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢å‘ã‘ä¿®æ­£æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆé›†**

## **Phase 1: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨˜æ†¶éšå±¤çµ±åˆ**

### **P1-1: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆåŸºç›¤ã€æœ€å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/characters/services/character-service.ts` (ãƒ¡ã‚¤ãƒ³ä¿®æ­£)
- `src/lib/characters/manager.ts` (é€£æºä¿®æ­£)

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/characters/core/types.ts`
- `src/lib/characters/core/interfaces.ts`
- `src/lib/memory/core/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P1-1: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆåŸºç›¤å®Ÿè£…ã€‘

â–  ç›®æ¨™
7ã¤ã®å°‚é–€ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆevolution, psychology, relationship, parameter, skill, detectionï¼‰ã‚’çµ±åˆã™ã‚‹æ–°ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã€è¨˜æ†¶éšå±¤ã¨ã®é€£æºåŸºç›¤ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
1. src/lib/characters/services/character-service.ts
   - æ—¢å­˜ã®23ãƒ¡ã‚½ãƒƒãƒ‰ã¯ä¿æŒ
   - ä»¥ä¸‹ã®æ–°ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ï¼š
     * async getUnifiedCharacterForPrompt(characterId: string, context: GenerationContext): Promise<UnifiedCharacterData>
     * async getCharacterWithMemoryHierarchy(characterId: string): Promise<HierarchicalCharacterData>
   
2. src/lib/characters/manager.ts
   - æ—¢å­˜ã®getCharacter()ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ‹¡å¼µ
   - UnifiedMemoryAccessã¨ã®é€£æºå¼·åŒ–

â–  å®Ÿè£…æ–¹é‡
- Promise.all()ã§7ã‚µãƒ¼ãƒ“ã‚¹ä¸¦åˆ—å‘¼ã³å‡ºã—
- è¨˜æ†¶éšå±¤ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ­ã‚¸ãƒƒã‚¯è¿½åŠ 
- æ—¢å­˜æ©Ÿèƒ½ã¸ã®å½±éŸ¿ã‚¼ãƒ­ã‚’ä¿è¨¼

â–  å¿…è¦ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©
```typescript
interface UnifiedCharacterData {
  character: CharacterWithDetails;
  evolution: CharacterEvolution;
  psychology: PsychologyAnalysis;
  relationships: RelationshipMap;
  parameters: DynamicParameters;
  skills: SkillProgression;
  detection: DetectionHistory;
}

interface HierarchicalCharacterData {
  shortTerm: CharacterShortTermData;
  midTerm: CharacterMidTermData;  
  longTerm: CharacterLongTermData;
}
```

â–  æˆåŠŸåŸºæº–
- æ–°ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æƒ…å ±è¦ç´ æ•°ã‚’50å€ã«å¢—åŠ 
- æ—¢å­˜ã®å…¨ãƒ†ã‚¹ãƒˆãŒç¶™ç¶šã—ã¦é€šé
- 7ã¤ã®å°‚é–€ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿çµ±åˆãŒæ­£å¸¸å‹•ä½œ
```

---

### **P1-2: å°‚é–€ã‚µãƒ¼ãƒ“ã‚¹è¨˜æ†¶éšå±¤é€£æºã€é«˜å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/characters/services/evolution-service.ts`
- `src/lib/characters/services/psychology-service.ts`
- `src/lib/characters/services/relationship-service.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/characters/core/types.ts`
- `src/lib/memory/core/interfaces.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P1-2: å°‚é–€ã‚µãƒ¼ãƒ“ã‚¹è¨˜æ†¶éšå±¤é€£æºå®Ÿè£…ï¼ˆã‚°ãƒ«ãƒ¼ãƒ—Aï¼‰ã€‘

â–  ç›®æ¨™
Evolutionã€Psychologyã€Relationshipã‚µãƒ¼ãƒ“ã‚¹ã«è¨˜æ†¶éšå±¤é€£æºæ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
å„ãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã®æ¨™æº–ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ï¼š
1. async getDataForMemoryHierarchy(): Promise<ServiceSpecificMemoryData>
2. async integrateWithMemoryLayer(layer: MemoryLayer): Promise<void>
3. async getHierarchicalData(characterId: string): Promise<HierarchicalServiceData>

â–  å„ã‚µãƒ¼ãƒ“ã‚¹å›ºæœ‰ã®å®Ÿè£…
- evolution-service.ts: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æˆé•·ãƒ‡ãƒ¼ã‚¿ã®éšå±¤åˆ†é¡
- psychology-service.ts: æ„Ÿæƒ…ãƒ»å¿ƒç†ãƒ‡ãƒ¼ã‚¿ã®éšå±¤åˆ†é¡  
- relationship-service.ts: é–¢ä¿‚æ€§ãƒ‡ãƒ¼ã‚¿ã®éšå±¤åˆ†é¡

â–  è¨˜æ†¶éšå±¤æˆ¦ç•¥
- çŸ­æœŸè¨˜æ†¶: ç¾åœ¨ã®çŠ¶æ…‹ã€æœ€è¿‘ã®å¤‰åŒ–
- ä¸­æœŸè¨˜æ†¶: é€²åŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ã€é–¢ä¿‚æ€§å¤‰åŒ–å±¥æ­´
- é•·æœŸè¨˜æ†¶: åŸºæœ¬äººæ ¼ã€èƒŒæ™¯å±¥æ­´ã€çµ±åˆè¨˜éŒ²

â–  å®Ÿè£…åˆ¶ç´„
- æ—¢å­˜ãƒ¡ã‚½ãƒƒãƒ‰ã¯ä¸€åˆ‡å¤‰æ›´ã—ãªã„
- æ—¢å­˜ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’20%ä»¥ä¸Šå¢—åŠ ã•ã›ãªã„
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“3ç§’ä»¥å†…ã‚’ç¶­æŒ

â–  æˆåŠŸåŸºæº–
- character-service.tsã®getUnifiedCharacterForPrompt()ã‹ã‚‰æ­£å¸¸ã«ãƒ‡ãƒ¼ã‚¿å–å¾—å¯èƒ½
- è¨˜æ†¶éšå±¤ã¸ã®é©åˆ‡ãªãƒ‡ãƒ¼ã‚¿æŒ¯ã‚Šåˆ†ã‘ãŒå‹•ä½œ
```

---

### **P1-3: å°‚é–€ã‚µãƒ¼ãƒ“ã‚¹è¨˜æ†¶éšå±¤é€£æºã€é«˜å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/characters/services/parameter-service.ts`
- `src/lib/characters/services/skill-service.ts`
- `src/lib/characters/services/detection-service.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/characters/core/types.ts`
- `src/lib/memory/core/interfaces.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P1-3: å°‚é–€ã‚µãƒ¼ãƒ“ã‚¹è¨˜æ†¶éšå±¤é€£æºå®Ÿè£…ï¼ˆã‚°ãƒ«ãƒ¼ãƒ—Bï¼‰ã€‘

â–  ç›®æ¨™
Parameterã€Skillã€Detectionã‚µãƒ¼ãƒ“ã‚¹ã«è¨˜æ†¶éšå±¤é€£æºæ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
P1-2ã¨åŒæ§˜ã®æ¨™æº–ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å„ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 

â–  å„ã‚µãƒ¼ãƒ“ã‚¹å›ºæœ‰ã®å®Ÿè£…
- parameter-service.ts: å‹•çš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®éšå±¤ç®¡ç†
- skill-service.ts: ã‚¹ã‚­ãƒ«ç¿’å¾—ãƒ»é€²æ­©ã®éšå±¤è¿½è·¡
- detection-service.ts: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æ¤œå‡ºå±¥æ­´ã®éšå±¤ä¿å­˜

â–  P1-2ã¨ã®é€£æº
- åŒã˜ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ä½¿ç”¨
- çµ±ä¸€ã•ã‚ŒãŸè¨˜æ†¶éšå±¤æˆ¦ç•¥ã‚’é©ç”¨
- character-service.tsã¨ã®çµ±åˆå‹•ä½œã‚’ä¿è¨¼

â–  æˆåŠŸåŸºæº–
- P1-2ã‚°ãƒ«ãƒ¼ãƒ—ã¨åˆã‚ã›ã¦6ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆãŒå®Œäº†
- å…¨ã‚µãƒ¼ãƒ“ã‚¹ãƒ‡ãƒ¼ã‚¿ãŒè¨˜æ†¶éšå±¤ã«é©åˆ‡é…ç½®
```

---

### **P1-4: è¨˜æ†¶éšå±¤ã‚³ã‚¢å®Ÿè£…ã€æœ€é«˜å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/memory/core/memory-manager.ts` (ãƒ¡ã‚¤ãƒ³ä¿®æ­£)
- `src/lib/memory/core/unified-access-api.ts` (é€£æºä¿®æ­£)

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/memory/core/types.ts`
- `src/lib/memory/core/interfaces.ts`
- `src/lib/characters/core/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P1-4: è¨˜æ†¶éšå±¤ã‚³ã‚¢å®Ÿè£…ã€‘

â–  ç›®æ¨™
memory-managerã«ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æƒ…å ±ã®è¨˜æ†¶éšå±¤è‡ªå‹•é…ç½®æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
1. src/lib/memory/core/memory-manager.ts
   - processChapter()ãƒ¡ã‚½ãƒƒãƒ‰å†…ã«åˆ†å²å‡¦ç†è¿½åŠ 
   - ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿éšå±¤åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…
   
2. src/lib/memory/core/unified-access-api.ts
   - getIntegratedCharacterData()ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
   - éšå±¤æ¨ªæ–­æ¤œç´¢æœ€é©åŒ–

â–  è¨˜æ†¶éšå±¤é…ç½®æˆ¦ç•¥
```typescript
const CHARACTER_MEMORY_STRATEGY = {
  shortTerm: {
    currentEmotionalState: "å³åº§ã‚¢ã‚¯ã‚»ã‚¹å¿…é ˆ",
    activeRelationships: "ç¾åœ¨ã®ã‚·ãƒ¼ãƒ³ç”¨", 
    recentAppearances: "ç›´è¿‘3ç« åˆ†"
  },
  midTerm: {
    characterEvolution: "æˆé•·ãƒ‘ã‚¿ãƒ¼ãƒ³è¿½è·¡",
    relationshipDynamics: "é–¢ä¿‚æ€§å¤‰åŒ–å±¥æ­´",
    skillProgression: "èƒ½åŠ›ç™ºé”è¨˜éŒ²"
  },
  longTerm: {
    corePersonality: "åŸºæœ¬äººæ ¼ãƒ‡ãƒ¼ã‚¿",
    backgroundHistory: "èƒŒæ™¯ãƒ»å±¥æ­´æƒ…å ±",
    masterCharacterRecord: "çµ±åˆã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨˜éŒ²"
  }
};
```

â–  å®Ÿè£…åˆ¶ç´„
- æ—¢å­˜ã®54,835ãƒã‚¤ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’50%ä»¥ä¸Šå¢—åŠ ã•ã›ãªã„
- æ—¢å­˜ã®32ãƒ¡ã‚½ãƒƒãƒ‰ã®å‹•ä½œã‚’ä¿æŒ
- ã‚³ãƒ³ã‚½ãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å‡¦ç†ã¸ã®å½±éŸ¿æœ€å°åŒ–

â–  æˆåŠŸåŸºæº–
- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒé©åˆ‡ãªéšå±¤ã«è‡ªå‹•é…ç½®
- P1-1ã€œP1-3ã§å®Ÿè£…ã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹é€£æºãŒæ­£å¸¸å‹•ä½œ
```

---

### **P1-5: è¨˜æ†¶éšå±¤ãƒ¬ã‚¤ãƒ¤ãƒ¼å¯¾å¿œã€ä¸­å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/memory/short-term/short-term-memory.ts`
- `src/lib/memory/mid-term/mid-term-memory.ts`
- `src/lib/memory/long-term/long-term-memory.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/memory/core/interfaces.ts`
- `src/lib/characters/core/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P1-5: è¨˜æ†¶éšå±¤ãƒ¬ã‚¤ãƒ¤ãƒ¼å¯¾å¿œå®Ÿè£…ã€‘

â–  ç›®æ¨™
3ã¤ã®è¨˜æ†¶å±¤ã§ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®å—ã‘å…¥ã‚Œãƒ»ä¿å­˜ãƒ»å–å¾—æ©Ÿèƒ½ã‚’å¼·åŒ–ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
å„ãƒ•ã‚¡ã‚¤ãƒ«ã®æ—¢å­˜addChapter()ãƒ¡ã‚½ãƒƒãƒ‰å†…ã«ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å‡¦ç†åˆ†å²è¿½åŠ 

â–  å„å±¤ã®å½¹å‰²
- short-term-memory.ts: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ çŠ¶æ…‹ã€ç¾åœ¨æ„Ÿæƒ…ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–é–¢ä¿‚æ€§
- mid-term-memory.ts: é€²åŒ–ãƒ‘ã‚¿ãƒ¼ãƒ³ã€é–¢ä¿‚æ€§å¤‰åŒ–ã€ã‚¹ã‚­ãƒ«é€²æ­©  
- long-term-memory.ts: åŸºæœ¬äººæ ¼ã€èƒŒæ™¯ã€çµ±åˆè¨˜éŒ²

â–  å®Ÿè£…æ–¹é‡
- æ—¢å­˜ã®ãƒ¡ã‚½ãƒƒãƒ‰æ§‹é€ ã‚’ç¶­æŒ
- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿å°‚ç”¨ã®å‡¦ç†ãƒ‘ã‚¹ã‚’è¿½åŠ 
- P1-4ã®memory-managerã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’é©åˆ‡ã«å‡¦ç†

â–  æˆåŠŸåŸºæº–
- å„å±¤ã§ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®é©åˆ‡ãªå‡¦ç†ãŒå®Œäº†
- P1-4ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿æŒ¯ã‚Šåˆ†ã‘ãŒæ­£å¸¸å‹•ä½œ
```

---

### **P1-6: çµ±åˆã‚·ã‚¹ãƒ†ãƒ æœ€é©åŒ–ã€ä½å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/memory/integration/access-optimizer.ts`
- `src/lib/memory/integration/cache-coordinator.ts`
- `src/lib/memory/integration/duplicate-resolver.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/memory/core/interfaces.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P1-6: çµ±åˆã‚·ã‚¹ãƒ†ãƒ æœ€é©åŒ–å®Ÿè£…ã€‘

â–  ç›®æ¨™
ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å°‚ç”¨ã®æœ€é©åŒ–ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»é‡è¤‡è§£æ±ºæ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
- access-optimizer.ts: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³æœ€é©åŒ–
- cache-coordinator.ts: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥è¿½åŠ 
- duplicate-resolver.ts: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é‡è¤‡è§£æ±ºå¼·åŒ–

â–  å®Ÿè£…æ–¹é‡
- æ—¢å­˜ã®æœ€é©åŒ–ãƒ­ã‚¸ãƒƒã‚¯ã«ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å°‚ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³è¿½åŠ 
- P1-1ã€œP1-5ã§å®Ÿè£…ã•ã‚ŒãŸæ©Ÿèƒ½ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š
- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®åŠ¹ç‡çš„ã‚¢ã‚¯ã‚»ã‚¹å®Ÿç¾

â–  æˆåŠŸåŸºæº–
- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã®20%é«˜é€ŸåŒ–
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ã®å‘ä¸Š
```

---

## **Phase 2: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ é©å‘½**

### **P2-1: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆã‚³ã‚¢é©å‘½ã€æœ€é«˜å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/generation/core/prompt-generator.ts` (ãƒ¡ã‚¤ãƒ³ä¿®æ­£)
- `src/lib/generation/core/context-generator.ts` (ãƒ¡ã‚¤ãƒ³ä¿®æ­£)

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/generation/core/types.ts`
- `src/lib/memory/core/types.ts`
- `src/lib/characters/core/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P2-1: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆã‚³ã‚¢é©å‘½å®Ÿè£…ã€‘

â–  ç›®æ¨™
8å¤§ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã®ä¸¦åˆ—ãƒ‡ãƒ¼ã‚¿åé›†ã¨çµ±åˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆã‚’å®Ÿè£…ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
1. src/lib/generation/core/prompt-generator.ts
   - generate()ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§8ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã®Promise.all()ãƒ‡ãƒ¼ã‚¿åé›†
   - buildSectionsWithUnifiedMemory()ã‚’8ã‚·ã‚¹ãƒ†ãƒ å¯¾å¿œã«æ‹¡å¼µ

2. src/lib/generation/core/context-generator.ts  
   - generateContext()ãƒ¡ã‚½ãƒƒãƒ‰ã‚’8ã‚·ã‚¹ãƒ†ãƒ çµ±åˆã«æ‹¡å¼µ
   - getCharacterGrowthInfoFromUnifiedMemory()ã®å¤§å¹…æ©Ÿèƒ½æ‹¡å¼µ

â–  8å¤§ã‚·ã‚¹ãƒ†ãƒ çµ±åˆãƒ‡ãƒ¼ã‚¿åé›†
```typescript
const [
  characterData,    // Phase 1ã§å®Ÿè£…ã—ãŸã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼çµ±åˆ
  learningContext,  // å­¦ç¿’æ—…ç¨‹ã‚·ã‚¹ãƒ†ãƒ 
  memoryContext,    // è¨˜æ†¶éšå±¤ã‚·ã‚¹ãƒ†ãƒ   
  plotContext,      // ãƒ—ãƒ­ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ 
  analysisResults,  // åˆ†æãƒ»ææ¡ˆã‚·ã‚¹ãƒ†ãƒ 
  parameters,       // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚·ã‚¹ãƒ†ãƒ 
  foreshadowing,    // ä¼ç·šç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
  systemStatus      // ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
] = await Promise.all([...]);
```

â–  å®Ÿè£…åˆ¶ç´„
- æ—¢å­˜ã®73,794ãƒã‚¤ãƒˆã€62,095ãƒã‚¤ãƒˆã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’2å€ä»¥ä¸Šã«ã—ãªã„
- æ—¢å­˜ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆæ©Ÿèƒ½ã‚’å®Œå…¨ä¿æŒ
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“5ç§’ä»¥å†…ã‚’ç¶­æŒ

â–  æˆåŠŸåŸºæº–
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæƒ…å ±å¯†åº¦ãŒ100å€å‘ä¸Š
- 8å¤§ã‚·ã‚¹ãƒ†ãƒ ãƒ‡ãƒ¼ã‚¿ãŒé©åˆ‡ã«çµ±åˆã•ã‚Œã‚‹
- æ—¢å­˜ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ãŒç¶™ç¶šå‹•ä½œ
```

---

### **P2-2: Section Bridgeå­¦ç¿’æ—…ç¨‹çµ±åˆã€é«˜å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/plot/section/section-bridge.ts` (ãƒ¡ã‚¤ãƒ³ä¿®æ­£)
- `src/lib/plot/section/section-plot-manager.ts` (é€£æºä¿®æ­£)

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/plot/section/types.ts`
- `src/lib/learning-journey/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P2-2: Section Bridgeå­¦ç¿’æ—…ç¨‹çµ±åˆå®Ÿè£…ã€‘

â–  ç›®æ¨™
ãƒ—ãƒ­ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ ã¨å­¦ç¿’æ—…ç¨‹ã®å®Œå…¨åŒæœŸã‚’å®Ÿç¾ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
1. src/lib/plot/section/section-bridge.ts
   - generateChapterContextWithSection()ãƒ¡ã‚½ãƒƒãƒ‰ã«å­¦ç¿’æ—…ç¨‹é€£æºè¿½åŠ 
   - LearningJourneySystemã¨ã®åŒæ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å®Ÿè£…

2. src/lib/plot/section/section-plot-manager.ts
   - integrateWithLearningJourney()ãƒ¡ã‚½ãƒƒãƒ‰æ©Ÿèƒ½æ‹¡å¼µ
   - Sectionå®šç¾©ã¨å­¦ç¿’ã‚¹ãƒ†ãƒ¼ã‚¸ã®å®Œå…¨åŒæœŸ

â–  åŒæœŸæˆ¦ç•¥
- ãƒ—ãƒ­ãƒƒãƒˆé€²è¡Œã¨å­¦ç¿’é€²è¡Œã®ä¸€è‡´åº¦å‘ä¸Š
- æ„Ÿæƒ…å­¦ç¿’ã¨ã‚¹ãƒˆãƒ¼ãƒªãƒ¼å±•é–‹ã®çµ±åˆ
- æ¦‚å¿µé€²è¡Œã¨ãƒ—ãƒ­ãƒƒãƒˆé€²è¡Œã®é€£æº

â–  å®Ÿè£…æ–¹é‡
- æ—¢å­˜ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†æ©Ÿèƒ½ã‚’ä¿æŒ
- å­¦ç¿’æ—…ç¨‹ãƒ‡ãƒ¼ã‚¿ã¨ã®åŒæ–¹å‘é€£æºè¿½åŠ 
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸæ©Ÿèƒ½ã®å®Ÿè£…

â–  æˆåŠŸåŸºæº–
- ãƒ—ãƒ­ãƒƒãƒˆé€²è¡Œã¨å­¦ç¿’ã‚¹ãƒ†ãƒ¼ã‚¸ã®å®Œå…¨åŒæœŸ
- ã‚»ã‚¯ã‚·ãƒ§ãƒ³Ã—å­¦ç¿’ã®çµ±åˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ
```

---

### **P2-3: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚·ã‚¹ãƒ†ãƒ çµ±åˆå¼·åŒ–ã€ä¸­å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/generation/prompt/template-manager.ts`
- `src/lib/generation/prompt/section-builder.ts`
- `src/lib/generation/prompt/prompt-formatter.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/generation/prompt/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P2-3: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚·ã‚¹ãƒ†ãƒ çµ±åˆå¼·åŒ–å®Ÿè£…ã€‘

â–  ç›®æ¨™
ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ»ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ã‚’8ã‚·ã‚¹ãƒ†ãƒ çµ±åˆãƒ‡ãƒ¼ã‚¿ã«å¯¾å¿œã•ã›ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
1. template-manager.ts: å‹•çš„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠæ©Ÿèƒ½è¿½åŠ 
2. section-builder.ts: 8ã‚·ã‚¹ãƒ†ãƒ çµ±åˆã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹ç¯‰  
3. prompt-formatter.ts: çµ±åˆãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¯¾å¿œ

â–  å®Ÿè£…æ–¹é‡
- P2-1ã§åé›†ã•ã‚Œã‚‹8ã‚·ã‚¹ãƒ†ãƒ ãƒ‡ãƒ¼ã‚¿ã®åŠ¹æœçš„æ´»ç”¨
- æ—¢å­˜ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ã¨ã®äº’æ›æ€§ç¶­æŒ
- å‹•çš„ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”Ÿæˆå¼·åŒ–

â–  æˆåŠŸåŸºæº–
- 8ã‚·ã‚¹ãƒ†ãƒ ãƒ‡ãƒ¼ã‚¿ãŒé©åˆ‡ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã•ã‚Œã‚‹
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å‹•çš„é¸æŠãŒæ­£å¸¸å‹•ä½œ
```

---

### **P2-4: ç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³çµ±åˆå¯¾å¿œã€ä¸­å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/generation/engine/chapter-generator.ts`
- `src/lib/plot/manager.ts`
- `src/lib/plot/story-generation-bridge.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/generation/types.ts`
- `src/lib/plot/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P2-4: ç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³çµ±åˆå¯¾å¿œå®Ÿè£…ã€‘

â–  ç›®æ¨™
ç« ç”Ÿæˆãƒ»ãƒ—ãƒ­ãƒƒãƒˆç®¡ç†ãƒ»ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ç”Ÿæˆãƒ–ãƒªãƒƒã‚¸ã‚’çµ±åˆãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã«å¯¾å¿œã•ã›ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
1. chapter-generator.ts: çµ±åˆãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å¯¾å¿œ
2. manager.ts: ãƒ—ãƒ­ãƒƒãƒˆÃ—å­¦ç¿’æ—…ç¨‹é€£æºå¼·åŒ–
3. story-generation-bridge.ts: çµ±åˆã‚¹ãƒˆãƒ¼ãƒªãƒ¼ç”Ÿæˆå¯¾å¿œ

â–  å®Ÿè£…æ–¹é‡
- P2-1ã€P2-2ã§å®Ÿè£…ã•ã‚ŒãŸçµ±åˆãƒ‡ãƒ¼ã‚¿ã®åŠ¹æœçš„æ´»ç”¨
- æ—¢å­˜ã®ç”Ÿæˆãƒ•ãƒ­ãƒ¼ã‚’ä¿æŒã—ã¤ã¤æ©Ÿèƒ½æ‹¡å¼µ
- 8ã‚·ã‚¹ãƒ†ãƒ é–“ã®ä¸€è²«æ€§ä¿è¨¼

â–  æˆåŠŸåŸºæº–
- çµ±åˆãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã—ãŸé«˜å“è³ªãªç« ç”Ÿæˆ
- ãƒ—ãƒ­ãƒƒãƒˆÃ—å­¦ç¿’æ—…ç¨‹ã®å®Œå…¨é€£æºå‹•ä½œ
```

---

## **Phase 3: å­¦ç¿’æ—…ç¨‹ãƒ»åˆ†æã‚·ã‚¹ãƒ†ãƒ çµ±åˆ**

### **P3-1: å­¦ç¿’æ—…ç¨‹ã‚³ã‚¢çµ±åˆã€æœ€é«˜å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/learning-journey/index.ts` (ãƒ¡ã‚¤ãƒ³ä¿®æ­£)
- `src/lib/learning-journey/concept-learning-manager.ts` (ãƒ¡ã‚¤ãƒ³ä¿®æ­£)

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/learning-journey/types.ts`
- `src/lib/characters/core/types.ts`
- `src/lib/plot/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P3-1: å­¦ç¿’æ—…ç¨‹ã‚³ã‚¢çµ±åˆå®Ÿè£…ã€‘

â–  ç›®æ¨™
å­¦ç¿’æ—…ç¨‹ã‚·ã‚¹ãƒ†ãƒ ã¨ãƒ—ãƒ­ãƒƒãƒˆãƒ»ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã®åŒæ–¹å‘é€£æºã‚’å®Ÿç¾ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
1. src/lib/learning-journey/index.ts
   - generateChapterPrompt()ãƒ¡ã‚½ãƒƒãƒ‰ã«ãƒ—ãƒ­ãƒƒãƒˆé€£æºè¿½åŠ 
   - getSectionWithFallback()ã‚’ãƒ—ãƒ­ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ é€£æºã«æ‹¡å¼µ

2. src/lib/learning-journey/concept-learning-manager.ts
   - getEmbodimentPlan()ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚·ã‚¹ãƒ†ãƒ é€£æºè¿½åŠ 
   - æ¦‚å¿µå­¦ç¿’ã¨ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç™ºé”ã®åŒæœŸæ©Ÿèƒ½å®Ÿè£…

â–  åŒæ–¹å‘é€£æºæˆ¦ç•¥
- å­¦ç¿’é€²è¡ŒãŒã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æˆé•·ã«åæ˜ 
- ãƒ—ãƒ­ãƒƒãƒˆé€²è¡ŒãŒå­¦ç¿’ã‚¹ãƒ†ãƒ¼ã‚¸ã«å½±éŸ¿
- æ¦‚å¿µå­¦ç¿’ãŒã‚¹ãƒˆãƒ¼ãƒªãƒ¼å±•é–‹ã‚’å¼·åŒ–

â–  å®Ÿè£…åˆ¶ç´„
- æ—¢å­˜ã®å­¦ç¿’æ—…ç¨‹æ©Ÿèƒ½ã‚’å®Œå…¨ä¿æŒ
- P2-2ã§å®Ÿè£…ã•ã‚ŒãŸSection Bridgeé€£æºã¨ã®æ•´åˆæ€§ä¿è¨¼
- å­¦ç¿’åŠ¹æœã®å®šé‡çš„æ¸¬å®šå¯èƒ½æ€§ç¶­æŒ

â–  æˆåŠŸåŸºæº–
- å­¦ç¿’æ—…ç¨‹Ã—ãƒ—ãƒ­ãƒƒãƒˆÃ—ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ä¸‰è€…åŒæœŸå®Ÿç¾
- æ¦‚å¿µå­¦ç¿’ã®å°èª¬ç”Ÿæˆã¸ã®ç›´æ¥åæ˜ ç¢ºèª
```

---

### **P3-2: æ„Ÿæƒ…ãƒ»å¤‰é©å­¦ç¿’çµ±åˆã€é«˜å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/learning-journey/emotional-learning-manager.ts`
- `src/lib/learning-journey/story-transformation-manager.ts`
- `src/lib/learning-journey/event-bus.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/learning-journey/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P3-2: æ„Ÿæƒ…ãƒ»å¤‰é©å­¦ç¿’çµ±åˆå®Ÿè£…ã€‘

â–  ç›®æ¨™
æ„Ÿæƒ…å­¦ç¿’ãƒ»ã‚¹ãƒˆãƒ¼ãƒªãƒ¼å¤‰é©ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒã‚¹ã‚’çµ±åˆã‚·ã‚¹ãƒ†ãƒ ã«å¯¾å¿œã•ã›ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
1. emotional-learning-manager.ts: æ„Ÿæƒ…Ã—ãƒ—ãƒ­ãƒƒãƒˆçµ±åˆ
2. story-transformation-manager.ts: å¤‰é©Ã—å“è³ªçµ±åˆ
3. event-bus.ts: å­¦ç¿’ã‚¤ãƒ™ãƒ³ãƒˆã®çµ±åˆã‚·ã‚¹ãƒ†ãƒ é…ä¿¡

â–  å®Ÿè£…æ–¹é‡
- P3-1ã§å®Ÿè£…ã•ã‚ŒãŸåŒæ–¹å‘é€£æºã®æ´»ç”¨
- æ„Ÿæƒ…å­¦ç¿’ãŒãƒ—ãƒ­ãƒƒãƒˆæ„Ÿæƒ…ã‚¢ãƒ¼ã‚¯ã«å½±éŸ¿
- å¤‰é©å­¦ç¿’ãŒå“è³ªå‘ä¸Šã«ç›´çµ

â–  æˆåŠŸåŸºæº–
- æ„Ÿæƒ…å­¦ç¿’Ã—ãƒ—ãƒ­ãƒƒãƒˆã®å®Œå…¨åŒæœŸ
- å¤‰é©å­¦ç¿’ã«ã‚ˆã‚‹å“è³ªå‘ä¸Šã®å®Ÿç¾
```

---

### **P3-3: åˆ†æã‚³ã‚¢çµ±åˆã€æœ€é«˜å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/analysis/coordinators/analysis-coordinator.ts` (ãƒ¡ã‚¤ãƒ³ä¿®æ­£)
- `src/lib/analysis/coordinators/optimization-coordinator.ts` (é€£æºä¿®æ­£)

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/analysis/types.ts`
- `src/lib/generation/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P3-3: åˆ†æã‚³ã‚¢çµ±åˆå®Ÿè£…ã€‘

â–  ç›®æ¨™
åˆ†æçµæœã®å³åº§åæ˜ ã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å“è³ªå‘ä¸Šæ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
1. src/lib/analysis/coordinators/analysis-coordinator.ts
   - analyzeChapter()ãƒ¡ã‚½ãƒƒãƒ‰ã«æ¨å¥¨äº‹é …è‡ªå‹•é©ç”¨æ©Ÿèƒ½è¿½åŠ 
   - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å“è³ªå‘ä¸Šãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—å®Ÿè£…

2. src/lib/analysis/coordinators/optimization-coordinator.ts
   - optimizeChapter()ãƒ¡ã‚½ãƒƒãƒ‰ã®æ¬¡å›ç”Ÿæˆã¸ã®è‡ªå‹•åæ˜ æ©Ÿèƒ½

â–  å³åº§åæ˜ æˆ¦ç•¥
- åˆ†æçµæœãŒæ¬¡ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆã«å³åº§åæ˜ 
- å“è³ªå•é¡Œã®è‡ªå‹•æ¤œå‡ºãƒ»ä¿®æ­£ææ¡ˆ
- ç¶™ç¶šçš„å­¦ç¿’ãƒ»æ”¹å–„ãƒ«ãƒ¼ãƒ—ã®å®Ÿè£…

â–  å®Ÿè£…åˆ¶ç´„
- åˆ†æå‡¦ç†ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“3ç§’ä»¥å†…ç¶­æŒ
- æ—¢å­˜ã®åˆ†ææ©Ÿèƒ½ã‚’å®Œå…¨ä¿æŒ
- P2-1ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆã¨ã®é€£æºä¿è¨¼

â–  æˆåŠŸåŸºæº–
- åˆ†æçµæœã«ã‚ˆã‚‹å³åº§ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–
- å“è³ªå‘ä¸Šã®å®šé‡çš„ãªç¢ºèª
```

---

### **P3-4: åˆ†æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³çµ±åˆã€ä¸­å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/analysis/pipelines/pre-generation-pipeline.ts`
- `src/lib/analysis/pipelines/post-generation-pipeline.ts`
- `src/lib/analysis/adapters/gemini-adapter.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/analysis/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P3-4: åˆ†æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³çµ±åˆå®Ÿè£…ã€‘

â–  ç›®æ¨™
äº‹å‰ãƒ»äº‹å¾Œåˆ†æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¨AIåˆ†æã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’çµ±åˆã‚·ã‚¹ãƒ†ãƒ ã«å¯¾å¿œã•ã›ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
1. pre-generation-pipeline.ts: äº‹å‰åˆ†æçµ±åˆ
2. post-generation-pipeline.ts: äº‹å¾Œåˆ†æçµ±åˆ  
3. gemini-adapter.ts: AIåˆ†æçµ±åˆ

â–  å®Ÿè£…æ–¹é‡
- P3-3ã§å®Ÿè£…ã•ã‚ŒãŸåˆ†æã‚³ã‚¢æ©Ÿèƒ½ã®æ´»ç”¨
- ç”Ÿæˆå‰å¾Œã§ã®åŒ…æ‹¬çš„å“è³ªä¿è¨¼
- AIåˆ†æèƒ½åŠ›ã®æœ€å¤§æ´»ç”¨

â–  æˆåŠŸåŸºæº–
- ç”Ÿæˆå‰å¾Œã®å®Œå…¨ãªå“è³ªä¿è¨¼å®Ÿç¾
- AIåˆ†æã«ã‚ˆã‚‹é«˜åº¦ãªæ¨å¥¨äº‹é …ç”Ÿæˆ
```

---

### **P3-5: åˆ†æã‚µãƒ¼ãƒ“ã‚¹çµ±åˆã€ä¸­å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/analysis/services/chapter-analysis-service.ts`
- `src/lib/analysis/services/character-analysis-service.ts`
- `src/lib/analysis/services/scene-analysis-service.ts`
- `src/lib/analysis/services/reader-experience-service.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/analysis/services/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P3-5: åˆ†æã‚µãƒ¼ãƒ“ã‚¹çµ±åˆå®Ÿè£…ã€‘

â–  ç›®æ¨™
ç« ãƒ»ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ»ã‚·ãƒ¼ãƒ³ãƒ»èª­è€…ä½“é¨“åˆ†æã‚µãƒ¼ãƒ“ã‚¹ã‚’çµ±åˆã‚·ã‚¹ãƒ†ãƒ ã«å¯¾å¿œã•ã›ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
å„åˆ†æã‚µãƒ¼ãƒ“ã‚¹ã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ†ææ©Ÿèƒ½ã‚’å¼·åŒ–

â–  å®Ÿè£…æ–¹é‡
- P3-3ã€P3-4ã§å®Ÿè£…ã•ã‚ŒãŸåˆ†æåŸºç›¤ã®æ´»ç”¨
- å„åˆ†æã‚µãƒ¼ãƒ“ã‚¹ã®å°‚é–€æ€§ã‚’ä¿æŒã—ã¤ã¤çµ±åˆå¯¾å¿œ
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ†æçµæœã®åŠ¹æœçš„æ´»ç”¨

â–  æˆåŠŸåŸºæº–
- å„åˆ†æã‚µãƒ¼ãƒ“ã‚¹ãŒçµ±åˆã‚·ã‚¹ãƒ†ãƒ ã«é©åˆ‡ã«é€£æº
- åˆ†æçµæœã®å“è³ªã¨é€Ÿåº¦ã®ä¸¡ç«‹å®Ÿç¾
```

---

## **Phase 4: ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£çµ±ä¸€**

### **P4-1: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸çµ±ä¸€ï¼ˆã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç³»ï¼‰ã€é«˜å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/characters/services/character-service.ts`
- `src/lib/characters/services/evolution-service.ts`
- `src/lib/characters/services/psychology-service.ts`
- `src/lib/characters/services/relationship-service.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/storage/index.ts`
- `src/lib/storage/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P4-1: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸çµ±ä¸€ï¼ˆã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç³»ï¼‰å®Ÿè£…ã€‘

â–  ç›®æ¨™
ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹ã‚’çµ±ä¸€ã‚·ã‚¹ãƒ†ãƒ ã«å¤‰æ›´ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
å…¨å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ç›´æ¥ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã‚’çµ±ä¸€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½¿ç”¨ã«å¤‰æ›´

â–  çµ±ä¸€ä¿®æ­£ãƒ‘ã‚¿ãƒ¼ãƒ³
```typescript
// å¤‰æ›´å‰
import fs from 'fs/promises';
const data = await fs.readFile(filePath);

// å¤‰æ›´å¾Œ  
import { storageProvider } from '@/lib/storage';
const data = await storageProvider.readFile(filePath);
```

â–  å®Ÿè£…åˆ¶ç´„
- æ—¢å­˜ã®æ©Ÿèƒ½ãƒ»æ€§èƒ½ã‚’ç¶­æŒ
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©å…ƒæ©Ÿèƒ½ã®è‡ªå‹•é©ç”¨
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®çµ±ä¸€

â–  æˆåŠŸåŸºæº–
- å…¨ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç³»ãƒ•ã‚¡ã‚¤ãƒ«ã§çµ±ä¸€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½¿ç”¨
- æ—¢å­˜æ©Ÿèƒ½ã®å®Œå…¨å‹•ä½œä¿è¨¼
- 20%ã®æ€§èƒ½å‘ä¸Šå®Ÿç¾
```

---

### **P4-2: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸çµ±ä¸€ï¼ˆãã®ä»–ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã€é«˜å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/characters/services/parameter-service.ts`
- `src/lib/characters/services/skill-service.ts`
- `src/lib/characters/services/detection-service.ts`
- `src/lib/learning-journey/*.ts` (å…¨6ãƒ•ã‚¡ã‚¤ãƒ«)

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/storage/index.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P4-2: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸çµ±ä¸€ï¼ˆãã®ä»–ã‚·ã‚¹ãƒ†ãƒ ï¼‰å®Ÿè£…ã€‘

â–  ç›®æ¨™
æ®‹ã‚Šã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç³»ã‚µãƒ¼ãƒ“ã‚¹ã¨å­¦ç¿’æ—…ç¨‹ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸çµ±ä¸€ã€‚

â–  ä¿®æ­£å¯¾è±¡
P4-1ã¨åŒæ§˜ã®çµ±ä¸€ä¿®æ­£ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é©ç”¨

â–  å®Ÿè£…æ–¹é‡
- P4-1ã§ç¢ºç«‹ã•ã‚ŒãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¸è¥²
- å­¦ç¿’æ—…ç¨‹ç³»ãƒ•ã‚¡ã‚¤ãƒ«ã®ç‰¹æ€§ã«å¿œã˜ãŸæœ€é©åŒ–
- çµ±ä¸€æ€§ã¨ã‚·ã‚¹ãƒ†ãƒ å›ºæœ‰æ€§ã®ãƒãƒ©ãƒ³ã‚¹

â–  æˆåŠŸåŸºæº–
- P4-1ã¨åˆã‚ã›ã¦å…¨ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ»å­¦ç¿’æ—…ç¨‹ç³»ã®çµ±ä¸€å®Œäº†
```

---

### **P4-3: API Throttlingçµ±ä¸€ã€æœ€é«˜å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/generation/core/gemini-client.ts`
- `src/lib/analysis/adapters/gemini-adapter.ts`
- `src/lib/learning-journey/concept-learning-manager.ts`
- `src/lib/characters/services/psychology-service.ts`
- `src/lib/foreshadowing/auto-generator.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/utils/api-throttle.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P4-3: API Throttlingçµ±ä¸€å®Ÿè£…ã€‘

â–  ç›®æ¨™
å…¨AIå‘¼ã³å‡ºã—ç®‡æ‰€ã§APIã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°ã‚’çµ±ä¸€ä½¿ç”¨ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
å…¨å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ç›´æ¥AIå‘¼ã³å‡ºã—ã‚’ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°çµŒç”±ã«å¤‰æ›´

â–  çµ±ä¸€ä¿®æ­£ãƒ‘ã‚¿ãƒ¼ãƒ³
```typescript
// å¤‰æ›´å‰
const result = await geminiClient.generateText(prompt);

// å¤‰æ›´å¾Œ
import { apiThrottler } from '@/lib/utils/api-throttle';
const result = await apiThrottler.execute(() => 
  geminiClient.generateText(prompt)
);
```

â–  å®Ÿè£…åˆ¶ç´„
- APIåˆ¶é™ã¸ã®å®Œå…¨æº–æ‹ 
- æ—¢å­˜ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ã‚’å¤§å¹…ã«æ‚ªåŒ–ã•ã›ãªã„
- ã‚¨ãƒ©ãƒ¼æ™‚ã®é©åˆ‡ãªãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½

â–  æˆåŠŸåŸºæº–
- å…¨AIå‘¼ã³å‡ºã—ã§ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°é©ç”¨
- APIåˆ¶é™ã‚¨ãƒ©ãƒ¼ã®å®Œå…¨æ’é™¤
- ã‚·ã‚¹ãƒ†ãƒ å®‰å®šæ€§ã®å‘ä¸Š
```

---

### **P4-4: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°çµ±ä¸€ï¼ˆé‡è¦ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã€ä¸­å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/generation/core/prompt-generator.ts`
- `src/lib/generation/core/context-generator.ts`
- `src/lib/memory/core/memory-manager.ts`
- `src/lib/characters/services/character-service.ts`
- `src/lib/plot/manager.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/utils/error-handler.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P4-4: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°çµ±ä¸€ï¼ˆé‡è¦ã‚·ã‚¹ãƒ†ãƒ ï¼‰å®Ÿè£…ã€‘

â–  ç›®æ¨™
é‡è¦ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’çµ±ä¸€ã‚·ã‚¹ãƒ†ãƒ ã«å¤‰æ›´ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
å€‹åˆ¥try-catchæ–‡ã‚’çµ±ä¸€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã«å¤‰æ›´

â–  çµ±ä¸€ä¿®æ­£ãƒ‘ã‚¿ãƒ¼ãƒ³
```typescript
// å¤‰æ›´å‰
try {
  // å‡¦ç†
} catch (error) {
  console.error(error);
}

// å¤‰æ›´å¾Œ
import { withErrorHandling } from '@/lib/utils/error-handler';
await withErrorHandling(async () => {
  // å‡¦ç†
}, 'operation-name');
```

â–  æˆåŠŸåŸºæº–
- é‡è¦ã‚·ã‚¹ãƒ†ãƒ ã§ã®çµ±ä¸€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°é©ç”¨
- ã‚¨ãƒ©ãƒ¼ç‡0.1%ä»¥ä¸‹ã®å®Ÿç¾
```

---

### **P4-5: ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ çµ±ä¸€ã€ä¸­å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- Phase 4ã®å…¨å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆç´„20ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/utils/logger.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P4-5: ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ çµ±ä¸€å®Ÿè£…ã€‘

â–  ç›®æ¨™
å…¨ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ­ã‚°å‡ºåŠ›ã‚’çµ±ä¸€ã‚·ã‚¹ãƒ†ãƒ ã«å¤‰æ›´ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
console.logç­‰ã®ç›´æ¥å‡ºåŠ›ã‚’çµ±ä¸€ãƒ­ã‚°ã‚·ã‚¹ãƒ†ãƒ ã«å¤‰æ›´

â–  çµ±ä¸€ä¿®æ­£ãƒ‘ã‚¿ãƒ¼ãƒ³
```typescript
// å¤‰æ›´å‰
console.log('Processing...');
console.error('Error occurred');

// å¤‰æ›´å¾Œ
import { logger } from '@/lib/utils/logger';
logger.info('Processing...', { context: 'operation-name' });
logger.error('Error occurred', { error, context: 'operation-name' });
```

â–  æˆåŠŸåŸºæº–
- å…¨ã‚·ã‚¹ãƒ†ãƒ ã§ã®çµ±ä¸€ãƒ­ã‚°ä½¿ç”¨
- æ§‹é€ åŒ–ãƒ­ã‚°ã«ã‚ˆã‚‹åˆ†ææ€§å‘ä¸Š
```

---

## **Phase 5: åˆæœŸåŒ–é †åºæœ€é©åŒ–**

### **P5-1: ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†ã‚³ã‚¢ã€æœ€é«˜å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/lifecycle/application-lifecycle-manager.ts` (ãƒ¡ã‚¤ãƒ³ä¿®æ­£)
- `src/lib/lifecycle/service-container.ts` (ãƒ¡ã‚¤ãƒ³ä¿®æ­£)

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/lifecycle/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P5-1: ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†ã‚³ã‚¢å®Ÿè£…ã€‘

â–  ç›®æ¨™
8å¤§ã‚·ã‚¹ãƒ†ãƒ ã®ä¾å­˜é–¢ä¿‚ã«åŸºã¥ãæœ€é©åˆæœŸåŒ–é †åºã‚’å®Ÿè£…ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
1. src/lib/lifecycle/application-lifecycle-manager.ts
   - initialize()ãƒ¡ã‚½ãƒƒãƒ‰ã«ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ—è¿½åŠ 
   - æ®µéšçš„åˆæœŸåŒ–ï¼ˆTier 1-5ï¼‰ã®å®Ÿè£…

2. src/lib/lifecycle/service-container.ts
   - DIå®¹å™¨ã«ã‚ˆã‚‹ä¾å­˜æ€§ç®¡ç†å¼·åŒ–
   - å¾ªç’°ä¾å­˜ã®è‡ªå‹•æ¤œå‡ºãƒ»è§£æ±º

â–  åˆæœŸåŒ–é †åºï¼ˆå³å®ˆï¼‰
```typescript
const INITIALIZATION_ORDER = {
  tier1: ['LifecycleSystem', 'ServiceContainer'],
  tier2: ['MemorySystem', 'ParametersSystem'],
  tier3: ['CharacterSystem', 'PlotSystem'], 
  tier4: ['LearningJourneySystem', 'ForeshadowingSystem'],
  tier5: ['AnalysisSystem', 'IntegrationLayer']
};
```

â–  å®Ÿè£…åˆ¶ç´„
- ä¾å­˜é–¢ä¿‚ã®å³å¯†ãªç®¡ç†
- åˆæœŸåŒ–å¤±æ•—æ™‚ã®é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
- ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®èµ·å‹•æ™‚é–“3ç§’ä»¥å†…

â–  æˆåŠŸåŸºæº–
- 8å¤§ã‚·ã‚¹ãƒ†ãƒ ã®æ­£ã—ã„é †åºã§ã®åˆæœŸåŒ–
- ä¾å­˜é–¢ä¿‚ã‚¨ãƒ©ãƒ¼ã®å®Œå…¨æ’é™¤
- ã‚·ã‚¹ãƒ†ãƒ å®‰å®šæ€§99.9%ã®å®Ÿç¾
```

---

### **P5-2: ã‚·ã‚¹ãƒ†ãƒ ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼åˆæœŸåŒ–å¯¾å¿œã€ä¸­å„ªå…ˆã€‘**

#### **å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**
- `src/lib/memory/core/memory-manager.ts`
- `src/lib/characters/manager.ts`
- `src/lib/plot/manager.ts`
- `src/lib/learning-journey/index.ts`
- `src/lib/analysis/coordinators/analysis-coordinator.ts`
- `src/lib/parameters/manager.ts`

#### **å…±æœ‰å¿…è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ**
- `src/lib/lifecycle/types.ts`

#### **ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æŒ‡ç¤ºãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**
```
ã€P5-2: ã‚·ã‚¹ãƒ†ãƒ ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼åˆæœŸåŒ–å¯¾å¿œå®Ÿè£…ã€‘

â–  ç›®æ¨™
å„ã‚·ã‚¹ãƒ†ãƒ ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’åˆæœŸåŒ–é †åºã«å¯¾å¿œã•ã›ã€ä¾å­˜é–¢ä¿‚ã‚’é©åˆ‡ã«ç®¡ç†ã™ã‚‹ã€‚

â–  ä¿®æ­£å¯¾è±¡
å„ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®åˆæœŸåŒ–ãƒ¡ã‚½ãƒƒãƒ‰ã«ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯ãƒ»å®£è¨€è¿½åŠ 

â–  å®Ÿè£…æ–¹é‡
- P5-1ã§å®Ÿè£…ã•ã‚ŒãŸåˆæœŸåŒ–é †åºã«æº–æ‹ 
- å„ã‚·ã‚¹ãƒ†ãƒ ã®ä¾å­˜é–¢ä¿‚ã‚’æ˜ç¢ºã«å®£è¨€
- åˆæœŸåŒ–å¤±æ•—æ™‚ã®é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

â–  ä¾å­˜é–¢ä¿‚å®£è¨€ä¾‹
```typescript
class MemoryManager {
  static dependencies = [];  // Tier 2: ä¾å­˜ãªã—
  static initializationTier = 2;
}

class CharacterManager {
  static dependencies = ['MemorySystem'];  // Tier 3: Memoryä¾å­˜
  static initializationTier = 3;
}
```

â–  æˆåŠŸåŸºæº–
- å…¨ã‚·ã‚¹ãƒ†ãƒ ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãŒæ­£ã—ã„é †åºã§åˆæœŸåŒ–
- ä¾å­˜é–¢ä¿‚ã®æ˜ç¢ºãªå®£è¨€ã¨æ¤œè¨¼
- P5-1ã¨ã®å®Œå…¨ãªé€£æºå‹•ä½œ
```

ã“ã®å®Ÿè£…è¨ˆç”»ã«ã‚ˆã‚Šã€å„æ‹…å½“ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒæ˜ç¢ºãªæŒ‡ç¤ºã«åŸºã¥ã„ã¦åŠ¹ç‡çš„ã«ä½œæ¥­ã‚’é€²ã‚ã€2,200+ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’100%ä»¥ä¸Šæ´»ç”¨ã§ãã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚’æ®µéšçš„ã«æ§‹ç¯‰ã§ãã¾ã™ã€‚